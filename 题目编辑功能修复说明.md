# 题目编辑功能修复说明

## 问题描述
在试卷管理界面，点击题目编辑时，无法正常获取题目的选项内容及分数，显示的是"[object Object]"。

## 问题原因
1. 后端返回的题目数据中，`options`字段是对象数组格式，每个对象包含`label`、`text`、`score`字段
2. 前端期望的是简单的字符串数组格式
3. 前端没有正确处理这种数据格式转换

## 修复方案
修改了前端`PaperManagement.tsx`文件中的`handleEditPaperQuestion`函数：

### 修复前
```javascript
editQuestionForm.setFieldsValue({
    content: question.content,
    type: question.type,
    shuffle_options: question.shuffle_options || false,
    options: question.options,  // 直接使用原始数据
    scores: question.scores
});
```

### 修复后
```javascript
// 处理options格式：如果是对象数组（包含label、text、score），转换为简单字符串数组
let processedOptions: string[] = [];
let processedScores: number[] = [];

if (options.length > 0 && typeof options[0] === 'object' && options[0].hasOwnProperty('text')) {
    // 如果是对象数组格式，提取text和score字段
    processedOptions = options.map((opt: any) => opt.text || '');
    processedScores = options.map((opt: any) => opt.score || 0);
} else if (Array.isArray(options)) {
    // 如果是简单字符串数组
    processedOptions = options;
    processedScores = question.scores || [];
}

editQuestionForm.setFieldsValue({
    content: question.content,
    type: question.type,
    shuffle_options: question.shuffle_options || false,
    options: processedOptions,  // 使用处理后的数据
    scores: processedScores
});
```

## 修复效果
1. ✅ 正确解析后端返回的题目数据格式
2. ✅ 将对象数组格式的选项转换为字符串数组
3. ✅ 正确提取每个选项对应的分数
4. ✅ 在编辑模态框中正确显示选项内容和分数
5. ✅ 支持保存编辑后的题目数据

## 测试验证
通过测试脚本验证了修复效果：
- 选项处理正确：所有选项都是字符串格式
- 分数处理正确：所有分数都是数字格式
- 数据转换准确：正确提取了text和score字段

## 兼容性
修复后的代码同时支持：
1. 对象数组格式的选项（包含label、text、score字段）
2. 简单字符串数组格式的选项
3. 确保向后兼容性

现在用户可以在试卷管理界面正常编辑题目，选项内容和分数都能正确显示和编辑。 